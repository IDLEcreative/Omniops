# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
NEXT_PUBLIC_SUPABASE_PROJECT_REF=your-project-ref-here

# Supabase Management API (for scripts only - DO NOT commit real tokens)
# Get from: https://supabase.com/dashboard/account/tokens
SUPABASE_MANAGEMENT_TOKEN=sbp_your_management_token_here

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here

# AI Model Configuration (REQUIRED)
# GPT-5 mini is now the only supported model (GPT-4 fallback removed)
# IMPORTANT: Do not use reasoning_effort='low' - causes tool calling issues. Use default (medium).
USE_GPT5_MINI=true

# Redis Configuration
# CRITICAL: Redis password is REQUIRED in production for security
# Generate strong password with: openssl rand -base64 32
# Example: xa3oUZT42pNPUSFRQtY+vbZ3xJxkojQuraFP6My9Bw0=
REDIS_PASSWORD=your-generated-redis-password-here

# Redis URL (automatically includes password from REDIS_PASSWORD)
# Local development: redis://:${REDIS_PASSWORD}@localhost:6379
# Docker: redis://:${REDIS_PASSWORD}@redis:6379
REDIS_URL=redis://:${REDIS_PASSWORD}@localhost:6379

# Encryption Key Configuration
# CRITICAL: REQUIRED for encrypting sensitive data (WooCommerce credentials, API keys, Shopify tokens)
# Requirements:
#   - Must be exactly 32 characters long
#   - Must have high entropy (at least 16 unique characters)
#   - Use cryptographically secure random generation
#
# Generate secure key with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex').substring(0,32))"
#
# Example output: a3f8e9b2c4d1f6a8e3b7c9d2f1a4b8c5
#
# SECURITY WARNINGS:
#   ⚠️  NEVER commit real encryption keys to version control
#   ⚠️  Changing this key will make ALL existing encrypted data unrecoverable
#   ⚠️  Store production keys in secure secret management (Vercel Secrets, AWS Secrets Manager, etc.)
#   ⚠️  Use different keys for development, staging, and production environments
#
# Validation: Key is validated on startup for length (32 chars) and entropy (16+ unique chars)
ENCRYPTION_KEY=your-32-character-encryption-key

# Request Signing Secret (HMAC-based request authentication)
# CRITICAL: REQUIRED for signing sensitive operations (GDPR deletion, data export, password reset)
# Requirements:
#   - Must be 32+ characters long
#   - Must have high entropy for security
#   - Use cryptographically secure random generation
#
# Generate secure secret with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# Example output: a3f8e9b2c4d1f6a8e3b7c9d2f1a4b8c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0
#
# SECURITY WARNINGS:
#   ⚠️  NEVER commit real signing secrets to version control
#   ⚠️  If not set, falls back to ENCRYPTION_KEY (not recommended for production)
#   ⚠️  Store production secrets in secure secret management (Vercel Secrets, AWS Secrets Manager, etc.)
#   ⚠️  Use different secrets for development, staging, and production environments
#
# Used for:
#   - GDPR data deletion requests (/api/gdpr/delete, /api/privacy/delete)
#   - GDPR data export requests (/api/gdpr/export)
#   - Password reset operations
#   - Payment-related operations
#   - Admin actions
REQUEST_SIGNING_SECRET=your-request-signing-secret-here

# CORS Configuration (Security)
# Comma-separated list of allowed origins for admin/sensitive endpoints
# Public endpoints (widget, embed, chat) allow all origins for embedding
# Admin endpoints restrict to this allowlist
# Example: https://omniops.co.uk,https://app.omniops.co.uk,https://admin.omniops.co.uk
# Wildcard patterns supported: *.omniops.co.uk
# Default (if not set): localhost:3000,localhost:3001,omniops.co.uk,www.omniops.co.uk
ALLOWED_ORIGINS=https://omniops.co.uk,https://www.omniops.co.uk,https://app.omniops.co.uk

# WooCommerce Configuration (optional)
WOOCOMMERCE_URL=https://your-woocommerce-store.com
WOOCOMMERCE_CONSUMER_KEY=ck_your_consumer_key_here
WOOCOMMERCE_CONSUMER_SECRET=cs_your_consumer_secret_here

# WooCommerce Store API Configuration (for direct cart manipulation)
# Enable direct cart operations (add to cart, update quantities, etc.)
# Default: false (uses informational mode with clickable URLs)
WOOCOMMERCE_STORE_API_ENABLED=false

# Store API Nonce (optional - for authenticated requests)
# If not provided, will use guest cart sessions
# WOOCOMMERCE_STORE_API_NONCE=your_nonce_here

# ========================================
# Scheduled Content Refresh Configuration
# ========================================

# Enable/disable automated content refresh (default: false)
CRON_ENABLED=true

# Cron schedule (default: "0 2 * * *" = 2 AM daily UTC)
# Examples:
#   "0 2 * * *"     - 2 AM daily
#   "0 */6 * * *"   - Every 6 hours
#   "0 0 * * 0"     - Every Sunday at midnight
CRON_SCHEDULE="0 2 * * *"

# Max pages to refresh per domain (default: -1 = unlimited)
CRON_MAX_PAGES=-1

# Refresh mode: "full" or "incremental" (default: "full")
# - full: Re-scrape all pages every time (slower, more accurate)
# - incremental: Only scrape changed pages (faster, cheaper)
CRON_REFRESH_MODE=full

# Security key for cron endpoint (REQUIRED if CRON_ENABLED=true)
CRON_SECRET=your-cron-secret-key-here

# Max retry attempts for failed domains (default: 3)
CRON_MAX_RETRIES=3

# Retry delay multiplier in seconds (default: 60)
# Delay = attempt * CRON_RETRY_DELAY (60s, 120s, 180s)
CRON_RETRY_DELAY=60

# ========================================
# Notification Configuration (Optional)
# ========================================

# Email notifications for cron failures
NOTIFICATION_EMAIL_ENABLED=false
NOTIFICATION_EMAIL_FROM=noreply@your-domain.com
NOTIFICATION_EMAIL_TO=admin@your-domain.com
# SMTP settings (only needed if email enabled)
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASS=your-smtp-password

# Slack notifications
NOTIFICATION_SLACK_ENABLED=false
NOTIFICATION_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Discord notifications
NOTIFICATION_DISCORD_ENABLED=false
NOTIFICATION_DISCORD_WEBHOOK=https://discord.com/api/webhooks/YOUR/WEBHOOK/URL

# Anthropic API (optional alternative to OpenAI)
# ANTHROPIC_API_KEY=sk-ant-your_anthropic_api_key_here

# Chat Response Configuration
# USE_SIMPLIFIED_PROMPT=true  # Enable concise responses (75 words max)

# AI Sentiment Analysis Configuration (optional)
# Enable OpenAI-powered sentiment analysis for 90-95% accuracy (vs 70-75% keyword-based)
# Cost: ~$0.021 per 1,000 messages, ~$0.63/month for 30k messages
# Set to 'true' to enable, 'false' or unset to use keyword-based analysis
ENABLE_AI_SENTIMENT=false
# Optional: Monthly cost threshold for warnings (default: $5)
# SENTIMENT_COST_THRESHOLD=5.0

# Domain Cache Configuration (optional)
# CACHE_PRELOAD_DOMAINS=example.com,localhost  # Comma-separated domains to preload on startup

# Embedding Cache Configuration (optional)
# EMBEDDING_CACHE_ENABLED=true  # Enable embedding cache (default: true)

# SMTP Configuration (for scheduled email reports)
# Example for Gmail: smtp.gmail.com:587 (use app password, not regular password)
# Example for SendGrid: smtp.sendgrid.net:587
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM="Analytics Reports <noreply@yourapp.com>"
# EMBEDDING_CACHE_MAX_SIZE=1000  # Maximum number of cached embeddings (default: 1000)
# EMBEDDING_CACHE_TTL_MINUTES=60  # Time-to-live for cached embeddings in minutes (default: 60)

# Debug Endpoints (Development Only)
# Set to 'true' to enable debug endpoints in production (not recommended)
# ENABLE_DEBUG_ENDPOINTS=false
# Metadata System Feature Flag (Week 2+)
# Set to 'true' to enable enhanced conversation context (requires prompt optimization)
# Default: false (metadata tracks but doesn't inject context into prompts)
# Metadata context is now always enabled (no feature flag needed)

# MCP Code Execution (Production Ready - Phase 3 Complete)
# Enable MCP code execution for AI-generated TypeScript code
# 96.2% token savings (5,002 tokens/message) - $1.2M projected annual savings
MCP_EXECUTION_ENABLED=true
# Enable progressive disclosure (reduces prompt tokens from 5,200 to 198 tokens)
MCP_PROGRESSIVE_DISCLOSURE=true
# Deno executable path (auto-detected if not set)
# DENO_PATH=/usr/local/bin/deno

# ========================================
# Stripe Billing Configuration (REQUIRED)
# ========================================
# Get test keys from: https://dashboard.stripe.com/test/apikeys
# Get live keys from: https://dashboard.stripe.com/apikeys

# Stripe API Keys
STRIPE_SECRET_KEY=sk_test_your_secret_key_here
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key_here

# Stripe Webhook Secret
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Stripe Price IDs - Get from https://dashboard.stripe.com/prices
# These map to the pricing tiers: Small Business, SME, Mid-Market, Enterprise
NEXT_PUBLIC_STRIPE_PRICE_SMALL_BUSINESS=price_small_business_id_here
NEXT_PUBLIC_STRIPE_PRICE_SME=price_sme_id_here
NEXT_PUBLIC_STRIPE_PRICE_MID_MARKET=price_mid_market_id_here
NEXT_PUBLIC_STRIPE_PRICE_ENTERPRISE=price_enterprise_id_here

# Legacy price IDs (kept for backwards compatibility)
NEXT_PUBLIC_STRIPE_STARTER_PRICE_ID=price_starter_id_here
NEXT_PUBLIC_STRIPE_PROFESSIONAL_PRICE_ID=price_professional_id_here

# Application URL - Set this to your production domain
# Used for embed code generation in the dashboard
# Local: http://localhost:3000
# Production: https://omniops.co.uk (or your actual domain)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Platform Owner Configuration
# Email address of the platform owner (for /owner dashboard access)
PLATFORM_OWNER_EMAIL=your-email@example.com

# ========================================
# AI Quote System Configuration (OPTIONAL)
# ========================================
# Get free API key from: https://developer.company-information.service.gov.uk/
# Required for Companies House company lookups (unlimited free requests)
COMPANIES_HOUSE_API_KEY=your_companies_house_api_key_here

# Optional: Cloudflare API token for traffic estimation
# Get from: https://dash.cloudflare.com/profile/api-tokens
# CLOUDFLARE_API_TOKEN=your_cloudflare_api_token_here

# Optional: SimilarWeb API key for accurate traffic data (£200/month)
# Get from: https://account.similarweb.com/
# SIMILARWEB_API_KEY=your_similarweb_api_key_here

# Optional: WHOIS API key for domain information
# Free tier available at: https://whoisxmlapi.com/
# WHOIS_API_KEY=your_whois_api_key_here

# ========================================
# Multi-Tenant Configuration (OPTIONAL)
# ========================================
# Configure your primary/test domain for health checks and testing
# This maintains brand-agnostic multi-tenant architecture
TEST_DOMAIN=example.com
PRIMARY_DOMAIN=example.com

# Domain aliases for staging/development environments
# Maps staging domains to production domains for widget testing
# Example: {"staging.example.com":"example.com","dev.example.com":"example.com"}
DOMAIN_ALIASES={}

# ========================================
# WhatsApp Business API Configuration (OPTIONAL)
# ========================================
# Enable customers to connect WhatsApp Business via OAuth
# Get credentials from: https://developers.facebook.com/apps

# Meta App Credentials (from Meta Developer Console)
META_APP_ID=your_meta_app_id_here
META_APP_SECRET=your_meta_app_secret_here

# Webhook Verification Token (generate random string - see guide)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
WHATSAPP_VERIFY_TOKEN=generate_random_string_here
WHATSAPP_APP_SECRET=same_as_meta_app_secret

# OAuth Redirect URL (automatically constructed from NEXT_PUBLIC_APP_URL)
# Must match Meta app settings: {NEXT_PUBLIC_APP_URL}/api/whatsapp/oauth/callback

# Provider Selection (default: 'meta')
# Options: 'meta' (Meta Cloud API - free) | 'twilio' (Twilio - paid)
WHATSAPP_PROVIDER=meta

# ========================================
# Instagram Messenger API Configuration (OPTIONAL)
# ========================================
# Enable customers to connect Instagram Business accounts via OAuth
# Get credentials from: https://developers.facebook.com/apps

# Instagram App Credentials (from Meta Developer Console)
# Create app at: https://developers.facebook.com/apps
# App Type: "Business" → Add "Instagram" product
INSTAGRAM_APP_ID=your_instagram_app_id_here
INSTAGRAM_APP_SECRET=your_instagram_app_secret_here

# OAuth Redirect URI (automatically constructed from NEXT_PUBLIC_APP_URL)
# Must match Meta app settings: {NEXT_PUBLIC_APP_URL}/api/instagram/callback
INSTAGRAM_REDIRECT_URI=http://localhost:3000/api/instagram/callback

# Webhook Verification Token (generate random string)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Use the SAME token in Meta app webhook configuration
INSTAGRAM_WEBHOOK_VERIFY_TOKEN=generate_random_string_here
